graph TB
    Input["EEG Features<br/>1140 dimensions<br/>6 frequency bands"]

    Preprocess["Feature Scaling<br/>(Z-score normalization)"]

    subgraph Ensemble["Ensemble Classifier"]
        KNN["K-Nearest Neighbors<br/>(k=9-15, manhattan)"]
        RF["Random Forest<br/>(100-500 trees)"]
        ET["Extra Trees<br/>(100-500 trees)"]
    end

    Vote["Weighted Voting<br/>(F1-based weights)"]
    Threshold["Optimal Threshold<br/>(from precision-recall curve)"]

    Output["Binary Prediction<br/>+ Probability<br/>+ Confidence Level"]

    Input --> Preprocess
    Preprocess --> KNN
    Preprocess --> RF
    Preprocess --> ET
    KNN --> Vote
    RF --> Vote
    ET --> Vote
    Vote --> Threshold
    Threshold --> Output

    style Input fill:#f9f9f9,stroke:#333,stroke-width:2px
    style Ensemble fill:#e8f4f8,stroke:#333,stroke-width:2px
    style Output fill:#fff4e8,stroke:#333,stroke-width:2px
