graph LR
    subgraph Input["User Input"]
        Patient[Select Patient<br/>9 Options]
        Disorder[Select Disorder<br/>17 Options]
        Action[Choose Action:<br/>Predict / SHAP / LIME<br/>PCA / t-SNE / UMAP<br/>Decision Path / Full Check]
    end

    subgraph Processing["Processing Pipeline"]
        LoadPatient[Load Patient<br/>1140 EEG Features]
        LoadModels[Load Models<br/>KNN + RF + ET]
        Scale[Feature Scaling<br/>StandardScaler]
        Predict[Ensemble Prediction<br/>Weighted Voting]
        Explain[Generate Explanation<br/>SHAP/LIME/PCA/etc.]
        AIGen[AI Interpretation<br/>Mistral API]
    end

    subgraph Output["Output to User"]
        Result[Prediction Result<br/>Present/Absent<br/>Probability<br/>Confidence]
        Visual[Interactive Visualization<br/>Charts & Plots]
        AIText[AI Clinical Interpretation<br/>Natural Language]
        FullReport[Full Check Report<br/>Top 5 Disorders<br/>Complete Table<br/>AI Summary]
    end

    Patient --> LoadPatient
    Disorder --> LoadModels
    Action --> LoadPatient

    LoadPatient --> Scale
    LoadModels --> Scale
    Scale --> Predict
    Predict --> Explain
    Explain --> AIGen

    Predict --> Result
    Explain --> Visual
    AIGen --> AIText
    Predict --> FullReport
    AIGen --> FullReport

    style Input fill:#0a1a1a,stroke:#00ff88,stroke-width:2px,color:#fff
    style Processing fill:#1a0a1a,stroke:#00ffff,stroke-width:2px,color:#fff
    style Output fill:#0a0a1a,stroke:#ff00ff,stroke-width:2px,color:#fff
